{"version":3,"sources":["../src/test/update-base-tag_test.ts"],"names":[],"mappings":"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","file":"update-base-tag_test.js","sourcesContent":["/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\nimport {assert} from 'chai';\nimport File = require('vinyl');\nimport * as path from 'path';\n\nimport {PolymerProject} from '../polymer-project';\n\nconst testProjectRoot = path.resolve('test-fixtures/differential-serving');\n\nsuite('updateBaseTag', () => {\n  let defaultProject: PolymerProject;\n\n  const unroot = ((p: string) => p.substring(testProjectRoot.length + 1));\n\n  setup(() => {\n    defaultProject = new PolymerProject({\n      root: 'test-fixtures/differential-serving/',\n      entrypoint: 'index.html',\n      shell: 'shell.html',\n    });\n  });\n\n  test('updates the entrypoint base tag', (done) => {\n    const files = new Map();\n    defaultProject.sources()\n        .pipe(defaultProject.updateBaseTag('/newBase/'))\n        .on('data', (f: File) => files.set(unroot(f.path), f))\n        .on('data', () => {/* starts the stream */})\n        .on('end', () => {\n          const expectedFiles = [\n            'index.html',\n            'shell.html',\n          ];\n          assert.deepEqual(Array.from(files.keys()).sort(), expectedFiles);\n\n          const index = files.get('index.html').contents.toString();\n          assert.include(index, 'index stuff');\n          assert.include(index, '<base href=\"/newBase/\">');\n          assert.notInclude(index, 'oldBase');\n\n          const shell = files.get('shell.html').contents.toString();\n          assert.include(shell, 'shell stuff');\n          assert.include(shell, 'shell-stuff/');\n          assert.notInclude(shell, 'newBase');\n          done();\n        });\n  });\n\n  test('does nothing when base tag doesn\\'t need updating', (done) => {\n    const files = new Map();\n    defaultProject.sources()\n        .pipe(defaultProject.updateBaseTag('/oldBase/'))\n        .on('data', (f: File) => files.set(unroot(f.path), f))\n        .on('data', () => {/* starts the stream */})\n        .on('end', () => {\n          const expectedFiles = [\n            'index.html',\n            'shell.html',\n          ];\n          assert.deepEqual(Array.from(files.keys()).sort(), expectedFiles);\n          const index = files.get('index.html').contents.toString();\n          assert.include(index, '<base href=\"/oldBase/\">');\n          done();\n        });\n  });\n});\n"]}