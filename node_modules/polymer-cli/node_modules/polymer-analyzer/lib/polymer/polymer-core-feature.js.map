{"version":3,"sources":["../src/polymer/polymer-core-feature.ts"],"names":[],"mappings":";AAAA;;;;;;;;;;;;GAYG;;AAEH,0CAAqC;AACrC,0CAAwI;AAExI;;GAEG;AACH,+BAAuC,SAAQ,sBAAc;IAA7D;;QAEE,aAAQ,GAAc,EAAE,CAAC;QACzB,eAAU,GAAG,IAAI,GAAG,EAA2B,CAAC;QAChD,YAAO,GAAG,IAAI,GAAG,EAAyB,CAAC;IAyD7C,CAAC;IAvDC,OAAO,CAAC,QAAkB;QACxB,IAAI,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;YAC5B,OAAO;SACR;QAED,0EAA0E;QAC1E,sEAAsE;QACtE,MAAM,oBAAoB,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,yBAAyB,CAAC,CAAC;QAEzE,IAAI,CAAC,oBAAoB,EAAE;YACzB,oEAAoE;YACpE,wCAAwC;YACxC,OAAO,IAAI,kBAAkB,CAAC,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;SAC9D;QAED,yEAAyE;QACzE,oEAAoE;QACpE,2EAA2E;QAC3E,mBAAmB;QACnB,MAAM,aAAa,GAA0B,IAAI,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QACtE,MAAM,UAAU,GAAwB,IAAI,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QAC9D,MAAM,iBAAiB,GAAG,QAAQ,CAAC,WAAW,CAAC;YAC7C,IAAI,EAAE,sBAAsB;YAC5B,QAAQ,EAAE,IAAI;YACd,gBAAgB,EAAE,IAAI;SACvB,CAAC,CAAC;QACH,KAAK,MAAM,OAAO,IAAI,iBAAiB,EAAE;YACvC,KAAK,MAAM,CAAC,GAAG,EAAE,IAAI,CAAC,IAAI,OAAO,CAAC,UAAU,EAAE;gBAC5C,aAAa,CAAC,GAAG,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;aAC9B;YACD,KAAK,MAAM,CAAC,GAAG,EAAE,MAAM,CAAC,IAAI,OAAO,CAAC,OAAO,EAAE;gBAC3C,UAAU,CAAC,GAAG,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;aAC7B;SACF;QAED,OAAO,IAAI,aAAK,CACZ;YACE,IAAI,EAAE,cAAc;YACpB,SAAS,EAAE,cAAc;YACzB,UAAU,EAAE,aAAa;YACzB,OAAO,EAAE,UAAU;YACnB,aAAa,EAAE,IAAI,GAAG,EAAE;YACxB,QAAQ,EAAE,IAAI;YACd,OAAO,EAAE,QAAQ;YACjB,4DAA4D;YAC5D,iEAAiE;YACjE,KAAK,EAAE,IAAI,CAAC,KAAK;YACjB,WAAW,EAAE,IAAI,CAAC,WAAW,IAAI,EAAE;YACnC,OAAO,EAAE,EAAE;YACX,WAAW,EAAE,IAAI,CAAC,WAAW;YAC7B,OAAO,EAAE,IAAI,CAAC,OAAO;YACrB,YAAY,EAAE,SAAS;SACxB,EACD,QAAQ,CAAC,CAAC;IAChB,CAAC;CACF;AA7DD,8DA6DC;AAQD;;GAEG;AACH;IAME,YACW,UAAiC,EACjC,OAA4B;QAD5B,eAAU,GAAV,UAAU,CAAuB;QACjC,YAAO,GAAP,OAAO,CAAqB;QAPvC,UAAK,GAAG,IAAI,GAAG,CAAC,CAAC,sBAAsB,CAAC,CAAC,CAAC;QAC1C,gBAAW,GAAG,IAAI,GAAG,EAAU,CAAC;QAChC,aAAQ,GAAc,EAAE,CAAC;QAChB,iBAAY,GAAG,SAAS,CAAC;IAKlC,CAAC;CACF;AAVD,gDAUC","file":"polymer-core-feature.js","sourcesContent":["/**\n * @license\n * Copyright (c) 2016 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\nimport {Class} from '../model/class';\nimport {Document, Feature, Method, Property, Resolvable, ScannedFeature, ScannedMethod, ScannedProperty, Warning} from '../model/model';\n\n/**\n * A scanned Polymer 1.x core \"feature\".\n */\nexport class ScannedPolymerCoreFeature extends ScannedFeature implements\n    Resolvable {\n  warnings: Warning[] = [];\n  properties = new Map<string, ScannedProperty>();\n  methods = new Map<string, ScannedMethod>();\n\n  resolve(document: Document): Feature|undefined {\n    if (this.warnings.length > 0) {\n      return;\n    }\n\n    // Sniff for the root `_addFeatures` call by presence of this method. This\n    // method must only appear once (in the root `polymer.html` document).\n    const isRootAddFeatureCall = this.methods.has('_finishRegisterFeatures');\n\n    if (!isRootAddFeatureCall) {\n      // We're at the `Polymer.Base` assignment or a regular `_addFeature`\n      // call. We'll merge all of these below.\n      return new PolymerCoreFeature(this.properties, this.methods);\n    }\n\n    // Otherwise we're at the root of the `_addFeatures` tree. Thanks to HTML\n    // imports, we can be sure that this is the final core feature we'll\n    // resolve. Now we'll emit a \"fake\" class representing the union of all the\n    // feature objects.\n    const allProperties: Map<string, Property> = new Map(this.properties);\n    const allMethods: Map<string, Method> = new Map(this.methods);\n    const otherCoreFeatures = document.getFeatures({\n      kind: 'polymer-core-feature',\n      imported: true,\n      externalPackages: true,\n    });\n    for (const feature of otherCoreFeatures) {\n      for (const [key, prop] of feature.properties) {\n        allProperties.set(key, prop);\n      }\n      for (const [key, method] of feature.methods) {\n        allMethods.set(key, method);\n      }\n    }\n\n    return new Class(\n        {\n          name: 'Polymer.Base',\n          className: 'Polymer.Base',\n          properties: allProperties,\n          methods: allMethods,\n          staticMethods: new Map(),\n          abstract: true,\n          privacy: 'public',\n          // TODO(aomarks) The following should probably come from the\n          // Polymer.Base assignment instead of this final addFeature call.\n          jsdoc: this.jsdoc,\n          description: this.description || '',\n          summary: '',\n          sourceRange: this.sourceRange,\n          astNode: this.astNode,\n          statementAst: undefined,\n        },\n        document);\n  }\n}\n\ndeclare module '../model/queryable' {\n  interface FeatureKindMap {\n    'polymer-core-feature': PolymerCoreFeature;\n  }\n}\n\n/**\n * A resolved Polymer 1.x core \"feature\".\n */\nexport class PolymerCoreFeature implements Feature {\n  kinds = new Set(['polymer-core-feature']);\n  identifiers = new Set<string>();\n  warnings: Warning[] = [];\n  readonly statementAst = undefined;\n\n  constructor(\n      public properties: Map<string, Property>,\n      public methods: Map<string, Method>) {\n  }\n}\n"]}