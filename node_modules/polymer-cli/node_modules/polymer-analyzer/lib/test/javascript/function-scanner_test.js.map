{"version":3,"sources":["../src/test/javascript/function-scanner_test.ts"],"names":[],"mappings":"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","file":"function-scanner_test.js","sourcesContent":["/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n\nimport {assert} from 'chai';\nimport * as path from 'path';\n\nimport {Analyzer} from '../../core/analyzer';\nimport {ScannedFunction} from '../../javascript/function';\nimport {FunctionScanner} from '../../javascript/function-scanner';\nimport {CodeUnderliner, createForDirectory, fixtureDir, runScanner} from '../test-utils';\n\nsuite('FunctionScanner', () => {\n  let analyzer: Analyzer;\n  let underliner: CodeUnderliner;\n  suiteSetup(async () => {\n    const testFilesDir = path.resolve(fixtureDir, 'namespaces/');\n    ({analyzer, underliner} = await createForDirectory(testFilesDir));\n  });\n\n  async function getNamespaceFunctions(filename: string) {\n    const {features} =\n        await runScanner(analyzer, new FunctionScanner(), filename);\n    const scannedFunctions = [];\n    for (const feature of features) {\n      if (feature instanceof ScannedFunction) {\n        scannedFunctions.push(feature);\n      }\n    }\n    return scannedFunctions;\n  }\n\n\n  async function getTestProps(fn: ScannedFunction) {\n    return {\n      name: fn.name,\n      description: fn.description,\n      summary: fn.summary,\n      warnings: fn.warnings,\n      params: fn.params,\n      return: fn.return,\n      codeSnippet: await underliner.underline(fn.sourceRange),\n      privacy: fn.privacy\n    };\n  }\n\n  test('recognizies functions', async () => {\n    const namespaceFunctions =\n        await getNamespaceFunctions('memberof-functions.js');\n    const functionData =\n        await Promise.all(namespaceFunctions.map(getTestProps));\n    assert.deepEqual(functionData, [\n      {\n        name: 'Polymer.aaa',\n        description: 'aaa',\n        summary: '',\n        warnings: [],\n        params: [{\n          desc: 'This is the first argument',\n          name: 'a',\n          type: 'Number',\n        }],\n        privacy: 'public',\n        return: undefined,\n        codeSnippet: `\nfunction aaa(a) {\n~~~~~~~~~~~~~~~~~\n  return a;\n~~~~~~~~~~~\n}\n~`,\n      },\n      {\n        name: 'Polymer.bbb',\n        description: 'bbb',\n        summary: '',\n        warnings: [],\n        params: [],\n        return: {type: 'void'},\n        privacy: 'public',\n        codeSnippet: `\nPolymer.bbb = function bbb() {\n              ~~~~~~~~~~~~~~~~\n\n\n};\n~`,\n      },\n      {\n        name: 'Polymer.ccc',\n        description: 'ccc',\n        summary: '',\n        warnings: [],\n        params: [],\n        return: {type: 'void'},\n        privacy: 'protected',\n        codeSnippet: `\n  function ccc() {\n  ~~~~~~~~~~~~~~~~\n  }\n~~~`,\n      },\n      {\n        name: 'Polymer._ddd',\n        description: 'ddd',\n        summary: '',\n        warnings: [],\n        privacy: 'protected',\n        params: [],\n        return: {type: 'void'},\n        codeSnippet: `\n  _ddd: function() {\n        ~~~~~~~~~~~~\n\n\n  },\n~~~`,\n      },\n      {\n        name: 'Polymer.eee',\n        description: 'eee',\n        summary: '',\n        warnings: [],\n        params: [],\n        return: {type: 'void'},\n        privacy: 'private',\n        codeSnippet: `\n  eee: () => {},\n       ~~~~~~~~`,\n      },\n      {\n        name: 'Polymer.fff',\n        description: 'fff',\n        summary: '',\n        warnings: [],\n        params: [],\n        return: {type: 'void'},\n        privacy: 'public',\n        codeSnippet: `\n  fff() {\n  ~~~~~~~\n\n\n  },\n~~~`,\n      },\n      {\n        name: 'Polymer.ggg',\n        description: 'ggg',\n        summary: '',\n        warnings: [],\n        params: [],\n        return: undefined,\n        privacy: 'public',\n        codeSnippet: `\n  ggg: someFunction,\n  ~~~~~~~~~~~~~~~~~`,\n      },\n      {\n        name: 'Polymer.hhh_',\n        description: 'hhh_ should be private',\n        summary: '',\n        warnings: [],\n        params: [],\n        return: undefined,\n        privacy: 'private',\n        codeSnippet: `\n  hhh_: someOtherFunc,\n  ~~~~~~~~~~~~~~~~~~~`,\n      },\n      {\n        name: 'Polymer.__iii',\n        description: '__iii should be private too',\n        summary: '',\n        warnings: [],\n        params: [],\n        return: {type: 'void'},\n        privacy: 'private',\n        codeSnippet: `\n  __iii() { },\n  ~~~~~~~~~~~`,\n      },\n      {\n        name: 'Polymer.jjj',\n        description: 'jjj',\n        summary: '',\n        warnings: [],\n        params: [],\n        return: {type: 'void'},\n        privacy: 'public',\n        codeSnippet: `\nvar jjj = function() {\n          ~~~~~~~~~~~~\n\n\n};\n~`,\n      },\n      {\n        name: 'lll',\n        description: 'lol\\n ',\n        summary: '',\n        warnings: [],\n        params: [],\n        return: {type: 'void'},\n        privacy: 'public',\n        codeSnippet: `\nexport function lll() {\n       ~~~~~~~~~~~~~~~~\n\n\n};\n~`,\n      },\n    ]);\n  });\n\n  test('handles @global, @memberof, @function annotations', async () => {\n    const functions = await getNamespaceFunctions('annotated-functions.js');\n    assert.deepEqual(functions.map((fn) => fn.name), [\n      'globalFn',\n      'SomeNamespace.memberofFn',\n      'overrideNameFn',\n    ]);\n  });\n\n  test('handles @template annotation', async () => {\n    const functions = await getNamespaceFunctions('templated-functions.js');\n    assert.deepEqual(functions.map((fn) => [fn.name, fn.templateTypes]), [\n      ['templateFn', ['T']],\n      ['multiTemplateFn', ['A', 'B', 'C']],\n    ]);\n  });\n\n  test('does return void inference', async () => {\n    const functions =\n        await getNamespaceFunctions('function-return-inference.js');\n    assert.deepEqual(functions.map((fn) => [fn.name, fn.return ]), [\n      ['noReturn', {type: 'void'}],\n      ['returnWithNoArgument', {type: 'void'}],\n      ['returnValue', undefined],\n      ['mixedReturnStyle', undefined],\n      ['voidWithNonVoidInside', {type: 'void'}],\n      ['isAsync', undefined],\n      ['isGenerator', undefined],\n      ['annotationOverride', {type: 'string'}],\n      ['arrowNoReturn', {type: 'void'}],\n      ['arrowReturnWithNoArgument', {type: 'void'}],\n      ['arrowReturnValueConcise', undefined],\n    ]);\n  });\n});\n"]}